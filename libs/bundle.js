!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";n(1),n(2),n(3),n(4),n(5)},function(t,e){"use strict";e.app=angular.module("app",["ngMaterial","ui.router","ngMessages","ngStorage"])},function(t,e,n){"use strict";var o=n(1).app;o.config(["$urlRouterProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.when("","/").otherwise("/")}]),o.config(["$stateProvider",function(t){t.state("index",{url:"/",controller:"IndexController",templateUrl:"/public/views/index.html"}).state("history",{url:"/history",controller:"HistoryController",templateUrl:"/public/views/history.html"})}])},function(t,e,n){"use strict";var o=n(1).app;o.controller("MainController",["$scope","$mdSidenav","$state","$mdDialog","$localStorage","$interval",function(t,e,n,o,i,a){i.$default({autoChange:!1,autoShowHelpInfo:!0,imagesHistory:[]}),t.autoChange={status:i.autoChange,interval:null},t.setAutoChange=function(){i.autoChange=t.autoChange.status},t.historyIndex=!1,t.setHistoryIndex=function(e){t.historyIndex=e},t.index=0,t.setIndex=function(e){t.index=e},t.images=[],t.openMenu=function(){e("left").toggle()},t.helpDialog={autoShow:i.autoShowHelpInfo},t.setHelpInfo=function(){i.autoShowHelpInfo=t.helpDialog.autoShow},t.showHelpDialog=function(){t.dialog=o.show({preserveScope:!0,scope:t,templateUrl:"/public/views/help.html",parent:angular.element(document.body),clickOutsideToClose:!0})},t.closeDialog=function(){o.hide(t.dialog)},t.menus=[{name:"首页",icon:"home",click:function(){return n.go("index")}},{name:"浏览记录",icon:"history",click:function(){return n.go("history")}},{name:"帮助",icon:"help_outline",click:function(){return t.showHelpDialog()}},{name:"关于本项目",icon:"code",click:function(){window.location="https://github.com/gyteng/jandan-ooxx"}}],t.menuClick=function(n){t.menus[n].click(),e("left").close()},t.$on("$stateChangeStart",function(e,n,o,i,r,s){"index"===i.name&&t.autoChange.interval&&a.cancel(t.autoChange.interval)})}])},function(t,e,n){"use strict";var o=n(1).app;o.controller("IndexController",["$scope","$http","$state","$stateParams","$timeout","$interval","$localStorage",function(t,e,n,o,i,a,r){r.autoShowHelpInfo&&!t.historyIndex&&t.showHelpDialog();var s=!1;t.getImages=function(){t.images.length>15||s||(s=!0,e.get("/random").then(function(e){s=!1,t.images.length||(r.imagesHistory.push(e.data),t.setIndex(0)),t.images.push(e.data),t.getImages()}).catch(function(){i(function(){s=!1,t.getImages()},2e3)}))},t.historyIndex&&(t.images[0]={id:r.imagesHistory[t.index].id,url:r.imagesHistory[t.index].url},t.setHistoryIndex(!1)),t.getImages(),t.random=function(e){t.getImages(),t.images.splice(0,1),t.images[0]&&r.imagesHistory.push(t.images[0]),r.imagesHistory.length>60&&r.imagesHistory.splice(0,r.imagesHistory.length-60),t.setIndex(r.imagesHistory.length-1),e||(t.autoChange.interval&&a.cancel(t.autoChange.interval),t.autoChange.status&&(t.autoChange.interval=a(function(){t.random(!0)},1e4)))},t.next=function(){t.index<r.imagesHistory.length-1?(t.setIndex(t.index+1),t.images[0]=r.imagesHistory[t.index]):t.random()},t.prev=function(){t.index>0&&(t.setIndex(t.index-1),t.images[0]=r.imagesHistory[t.index])},t.$watch("autoChange.status",function(){return t.autoChange.status?void(t.autoChange.interval=a(function(){t.random(!0)},1e4)):void(t.autoChange.interval&&a.cancel(t.autoChange.interval))})}])},function(t,e,n){"use strict";var o=n(1).app;o.controller("HistoryController",["$scope","$localStorage","$state","$mdMedia",function(t,e,n,o){return e.imagesHistory?(t.divHeightStyle={height:100/3+"vw"},o("md")&&(t.divHeightStyle.height="25vw"),o("gt-md")&&(t.divHeightStyle.height=100/6+"vw"),t.history=e.imagesHistory.map(function(t){return{id:t.id,url:t.url,width:1,height:1,style:{width:"100%",overflow:"hidden"}}}),t.history.forEach(function(e,n){var o=new Image;o.onload=function(){t.history[n].width=o.width,t.history[n].height=o.height,o.height<o.width&&(t.history[n].style={height:"100%","max-width":"none","min-width":100/e.height*e.width+"%"})},o.src=e.url}),void(t.toImage=function(e){t.setHistoryIndex(!0),t.setIndex(e),n.go("index")})):n.go("index")}])}]);